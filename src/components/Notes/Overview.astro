---
import type { CollectionEntry } from 'astro:content'
import type { Page } from 'astro'
import PageLayout from '../../layouts/PageLayout.astro'
import getTitle from '../../utils/getTitle'
import Pagination from '../App/Pagination.astro'
import LinkedCard from '../Card/LinkedCard.astro'
import formatDate from '../../utils/formatDate'

interface Props {
  notes: CollectionEntry<'notes'>[]
  page: Page<CollectionEntry<'notes'>>
  category: CollectionEntry<'notes'>['data']['category']
}

const { notes, page, category } = Astro.props
---

<PageLayout title={getTitle('All Notes')} description="All Notes">
  <div class="grow">
    <ul class="space-y-4">
      {
        notes.map((note) => (
          <li>
            <LinkedCard
              url={`/notes/${note.id}`}
              img={note.data.image}
              imgAlt={note.data.title}
              title={note.data.title}
            >
              <p class="line-clamp-2 mb-2">{note.data.description}</p>
              {note.data.pubDate && (
                <time
                  class="ml-auto mt-auto flex"
                  datetime={note.data.pubDate.toISOString()}
                >
                  {formatDate(note.data.pubDate)}
                </time>
              )}
            </LinkedCard>
          </li>
        ))
      }
    </ul>
    <Pagination page={page} {category} />
  </div>
</PageLayout>
