---
import { navBarConfig } from '../../config'
import { Icon } from 'astro-icon/components'
import IconButton from '../Buttons/IconButton.astro'

const pathname = new URL(Astro.request.url).pathname
const currentPath = pathname.slice(1) // remove the first "/"

function isActiveLink(url: string) {
  return currentPath.startsWith(url.slice(1))
}
---

<nav class="ml-auto max-sm:hidden flex gap-8">
  {
    navBarConfig.links.map((link) => {
      return (
        <>
          {/* Avoid adding a space before the file name */}
          {/* prettier-ignore */}
          <a class:list={[
              isActiveLink(link.url) && 'font-bold underline',
              'hover:text-secondary transition-all',
            ]} href={link.url} target={link.target}>{link.name}</a>
        </>
      )
    })
  }
</nav>

<IconButton class="ml-auto hidden max-sm:flex relative group">
  <span class="sr-only">Menu</span>
  <Icon class="w-6 h-6 m-auto" name="material-symbols:menu-rounded" />
  <nav
    class="border border-neutral-500 absolute top-8 -left-full rounded-xl shadow-xl bg-base hidden group-hover:block animate-in fade-in"
  >
    {
      navBarConfig.links.map((link) => {
        return (
          <a
            class:list={[
              isActiveLink(link.url) && 'font-bold underline',
              'flex items-center px-2 py-2 first:rounded-t-xl last:rounded-b-xl hover:bg-hover transition-all',
            ]}
            href={link.url}
            target={link.target}
          >
            {link.name}
            {/* <Icon
              class="w-6 h-6 ml-auto"
              name="material-symbols:chevron-right-rounded"
            /> */}
          </a>
        )
      })
    }
  </nav>
</IconButton>
