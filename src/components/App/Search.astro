---
import PageFindSearch from 'astro-pagefind/components/Search'
---

<dialog
  id="search-dialog"
  class:list={[
    'pagefind',
    'backdrop:backdrop-blur backdrop:backdrop-saturate-150',
    'rounded-xl bg-base w-full md:max-w-2xl mt-0 sm:mt-28',
  ]}
>
  <PageFindSearch className="p-4" />
</dialog>

<script is:inline>
  const searchDialog = document.querySelector('#search-dialog')
  searchDialog.addEventListener('click', (event) => {
    if (event.target.nodeName.toLowerCase() === 'dialog') {
      searchDialog.close()
    }
  })
</script>

<style>
  .pagefind {
    --pagefind-ui-primary: rgb(var(--color-base));
    --pagefind-ui-text: rgb(var(--color-primary));
    --pagefind-ui-background: rgb(var(--color-back));
    --pagefind-ui-border: rgb(var(--color-secondary));
    --pagefind-ui-border-radius: 0.75rem;
    --pagefind-ui-border-width: 1px;

    & :global(.pagefind-ui__search-input),
    & :global(.pagefind-ui__button) {
      @apply bg-back/75 outline-none border-transparent transition-all;
    }

    & :global(.pagefind-ui__search-input:focus-visible),
    & :global(.pagefind-ui__button:hover),
    & :global(.pagefind-ui__button:focus) {
      @apply bg-back border-primary;
    }

    & :global(.pagefind-ui__result) {
      @apply wrap-anywhere;
    }

    & :global(.pagefind-ui__results-area) {
      @apply overflow-auto max-h-[50vh] pr-4;
    }

    & :global(.pagefind-ui__result-title .pagefind-ui__result-link) {
      @apply inline-block underline transition-none;
    }

    &
      :global(
        .pagefind-ui__result-title .pagefind-ui__result-link::first-letter
      ) {
      @apply text-highlight;
    }

    & :global(.pagefind-ui__search-clear) {
      @apply bg-transparent;
    }

    & :global(.pagefind-ui__result-title .pagefind-ui__result-link:hover),
    & :global(.pagefind-ui__result-title .pagefind-ui__result-link:focus),
    & :global(.pagefind-ui__search-clear:hover),
    & :global(.pagefind-ui__search-clear:focus) {
      @apply text-secondary;
    }

    & :global(.pagefind-ui__result-thumb) {
      @apply min-w-24;
    }

    & :global(.pagefind-ui__button) {
      @apply text-primary border border-secondary;
    }
  }
</style>
