---
import BaseHead from '../components/App/BaseHead.astro'
import Header from '../components/App/Header.astro'
import Footer from '../components/App/Footer.astro'
import Search from '../components/App/Search.astro'
import { siteConfig } from '../config'

interface Props {
  title?: string
  description?: string
  image?: string
}

const {
  title = [siteConfig.description, siteConfig.title].join(' | '),
  description = siteConfig.description,
  image = siteConfig.avatar,
} = Astro.props
---

<!doctype html>
<html lang={String(siteConfig.language)} dir={siteConfig.direction}>
  <head>
    <BaseHead title={title} description={description} image={image} />
    <script is:inline>
      const setTheme = (theme) => {
        document.documentElement.classList.add(theme)
      }

      let theme = (() => {
        if (
          typeof localStorage !== 'undefined' &&
          localStorage.getItem('theme')
        ) {
          return localStorage.getItem('theme')
        }
        if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
          return 'dark'
        }
        return 'light'
      })()

      theme === 'light' ? setTheme('light') : setTheme('dark')
      localStorage.setItem('theme', theme)
    </script></head
  >

  <body>
    <Search />
    <Header />
    <slot />
    <Footer />
  </body>
</html>
